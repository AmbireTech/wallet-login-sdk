"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("@web3-react/types"),t=require("@ethersproject/providers"),r=(e=require("assets/ambire.png"))&&"object"==typeof e&&"default"in e?e.default:e,s=require("@web3-onboard/common");function i(e,n,t,r,s,i,a){try{var o=e[i](a),c=o.value}catch(e){return void t(e)}o.done?n(c):Promise.resolve(c).then(r,s)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function o(e){i(a,r,s,o,c,"next",e)}function c(e){i(a,r,s,o,c,"throw",e)}o(void 0)}))}}class o extends t.JsonRpcProvider{constructor(e,n,t,r){super(t,r),this._address=n,this._sdk=e}getSigner(e){var n=super.getSigner(e||this._address),t=this,r={get:(e,s,i)=>"sendTransaction"===s&&e[s]instanceof Function?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var s=n.data?n:n[0],i=s.value?s.value.toString():"0";return t._sdk.openSendTransaction(s.to,i,s.data),new Promise((e,n)=>{t._sdk.onTxnSent(function(){var n=a((function*(n){var r=n.hash,i=yield t.getTransaction(r),a=t._wrapTransaction(i,r);return a.data=s.data,e(a)}));return function(e){return n.apply(this,arguments)}}()),t._sdk.onTxnRejected(()=>{n({code:4001})})})}:"connectUnchecked"===s&&e[s]instanceof Function?function(){return new Proxy(n,r)}:("signMessage"===s||"_legacySignMessage"===s||"_signTypedData"===s)&&e[s]instanceof Function?function(){for(var e="signMessage"===s?"personal_sign":"_legacySignMessage"===s?"eth_sign":"eth_signTypedData_v4",n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.handleMsgSign(e,r)}:Reflect.get(e,s,i)};return new Proxy(n,r)}handleMsgSign(e,n){return this._sdk.openSignMessage(e,1===n.length?n[0]:n),new Promise((e,t)=>{this._sdk.msgSigned(()=>e(n[0])),this._sdk.onMsgRejected(()=>{t({code:4001})})})}}exports.AmbireWallet=class extends n.Connector{constructor(e,n,t){super(e,t),this._sdk=new window.AmbireSDK(n)}activate(e){return this.actions.startActivation(),this._sdk.openLogin(e),new Promise((n,t)=>{this._sdk.onAlreadyLoggedIn(t=>{var r=e?parseInt(e.chainId):parseInt(t.chainId);this.customProvider=this.getProvider(t.address,t.providerUrl),this.actions.update({chainId:r,accounts:[t.address]}),n()}),this._sdk.onLoginSuccess(t=>{var r=e?parseInt(e.chainId):parseInt(t.chainId);this.customProvider=this.getProvider(t.address,t.providerUrl),this.actions.update({chainId:r,accounts:[t.address]}),n()}),this._sdk.onRegistrationSuccess(t=>{var r=e?e.chainId:t.chainId;this.customProvider=this.getProvider(t.address,t.providerUrl),this.actions.update({chainId:r,accounts:[t.address]}),n()}),this._sdk.onActionRejected(e=>{var n=parseInt(e.chainId);this.customProvider=this.getProvider(e.address,e.providerUrl),this.actions.update({chainId:n,accounts:[e.address]}),t({code:4001,message:"User rejected the request."})})})}deactivate(){return this._sdk.openLogout(),new Promise(e=>{this._sdk.onLogoutSuccess(()=>{this.customProvider=null,this.actions.resetState(),e()})})}getProvider(e,n){return new o(this._sdk,e,n)}},exports.Web3OnboardAmbireWalletModule=function(e){var n=new window.AmbireSDK(e),t=[],i="0x1",o=function(){var e=a((function*(){return n.openLogin({chainId:parseInt(i)}),new Promise((e,r)=>{n.onLoginSuccess(n=>{t=[n.address],i="0x"+parseInt(n.chainId).toString(16),e(t)}),n.onAlreadyLoggedIn(n=>{t=[n.address],i="0x"+parseInt(n.chainId).toString(16),e(t)}),n.onRegistrationSuccess(n=>{t=[n.address],i="0x"+parseInt(n.chainId).toString(16),e(t)}),n.onActionRejected(e=>{t=[e.address],r({code:4001,message:"User rejected the request."})})})}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=a((function*(e,t){return n.openSignMessage(e,t),new Promise((e,t)=>{n.onMsgSigned(n=>e(n.signature)),n.onMsgRejected(()=>{t({code:4001,message:"User rejected the request."})})})}));return function(n,t){return e.apply(this,arguments)}}();return()=>{return{label:"Ambire Wallet",getIcon:(d=a((function*(){return r})),function(){return d.apply(this,arguments)}),getInterface:(e=a((function*(e){var r,d,u,h,p,g,l,v,f,{EventEmitter:_}=e,m=new _,y={eth_requestAccounts:(f=a((function*(){return t.length>0?Promise.resolve(t):o()})),function(){return f.apply(this,arguments)}),eth_selectAccounts:(v=a((function*(){return t.length>0?Promise.resolve(t):o()})),function(){return v.apply(this,arguments)}),eth_accounts:(l=a((function*(){return Promise.resolve(t)})),function(){return l.apply(this,arguments)}),eth_chainId:(g=a((function*(){return Promise.resolve(i)})),function(){return g.apply(this,arguments)}),personal_sign:(p=a((function*(e){var{params:[n,t]}=e;return c("personal_sign",n)})),function(e){return p.apply(this,arguments)}),eth_sign:(h=a((function*(e){var{params:[n,t]}=e;return c("eth_sign",t)})),function(e){return h.apply(this,arguments)}),eth_signTypedData:(u=a((function*(e){var{params:[n,t]}=e;return c("eth_signTypedData",t)})),function(e){return u.apply(this,arguments)}),eth_signTypedData_v4:(d=a((function*(e){var{params:[n,t]}=e;return c("eth_signTypedData_v4",t)})),function(e){return d.apply(this,arguments)}),eth_sendTransaction:(r=a((function*(e){var{params:[t]}=e,r=t.to.toString(),s=t.value.toString(),i=t.data?t.data.toString():"0x";return n.openSendTransaction(r,s,i),new Promise((e,t)=>{n.onTxnSent(n=>e(n.hash)),n.onTxnRejected(()=>{t({code:4001,message:"User rejected the request."})})})})),function(e){return r.apply(this,arguments)})};return{provider:s.createEIP1193Provider({on:m.on.bind(m)},y)}})),function(n){return e.apply(this,arguments)}),platforms:["all"]};var e,d}};
//# sourceMappingURL=ambire-login-sdk.cjs.production.min.js.map
